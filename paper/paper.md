---
title: 'BPP: the bacterial polyploidy predictor based on complete genomic assemblies'
tags:
  - Python
  - Bacterial genomics
  - Microbial ecology
  - Microbiome
authors:
  - name: Zhenxiong Jiang
    orcid: 0000-0002-7912-1934
    equal-contrib: false
    affiliation: "1"
  - name: Raquel Dias
    orcid: 0000-0002-8387-1324
    corresponding: true
    affiliation: "1"
affiliations:
 - name: Department of Microbiology and Cell Science, University of Florida, Gainesville, Florida, 32611, USA
   index: 1
date: 7 August 2025

bibliography: paper.bib

---

# Summary
BacterialPloidyPredictor (BPP) is a Python-based package that batch predicts the bacterial polyploidy based off of global genomic architecture. BacterialPloidyPredictor automates the extraction of features from complete assemblies of bacterial species, and predicts polyploidy by feeding extracted features into pre-trained machine learning models. Besides, BPP provides a series of visualizations to help comprehend the difference in global genomic architecture, and to estimate the confidence of the prediction. For instance, it visualizes the global genomic features used to predict polyploidy, the position of the sample(s) in the 3-dimentional space formed by first three principal components (PC1-PC3) generated by training data, and the Euclidean distance to the closest reference point among two distributions formed by reference points either within group or between two groups. This package serves as the first computational tool to predict polyploidy in bacteria, with the goal to explore the biological significance of polyploidy as a prevalent phenotype, and potentiates ploidy quantification in the future. 

# Statement of need
Recent predictions challenges the previous consensus that most bacteria are monoploids [@Soppa2022-kb]. If proven, this new finding could significantly change the way we analyze microbiology data. For example, microbiome-wide association study (MWAS) has been developed to find bacterial taxa associated with diseases and disorders [@Gilbert2016-cl; @Surana2017-kq]. This method is built based on the assumption that all bacteria are monoploids such that the fold change of components reflects the fluctuation of taxa population size. However, if majority of bacteria are polyploids, the normalization of bacterial abundance based on ploidy level becomes necessary to ameliorate the overrepresentation of species, and can thus help identify species with a higher significance in disease onset or development [@Soppa2017-uc]. Furthermore, it becomes clearer that polyploid bacteria co-exist with monoploid bacteria, this observation further raises up the question about the biological significance of polyploidy beside the theories that have been previously revealed [@Van_de_Peer2017-vq]. Unfortunately, several factors hinders further investigation of this topic: First, quantification of ploidy level is a time consuming task. The current method based on qPCR and cell direct counting is a tedious work and awaits a platform allowing higher throughput. Second, the number of bacteria with quantified ploidy level from prrevious studies is limited for the development of prediction tools that rely on big amount of data for model training; third, the dynamic nature of polyploidy makes the collection of data trickier. For example, some, if not all, monoploid bacteria such as *E.coli* can go through polyploidization during fast growing phase, which is known as mero-polyploidy. This phenomenon is believed to increases the gene dosage to support its fast growth [@Hu2025-hi], which complicates the quantification of true polyploidy as the ploidy is a dynamic range. To differentiate, polyploidy in this work is defined as the mantenance of multiple copies of chromosomes at all growing phase. As the first step to launch a thorough investigation, BPP is developed to perform a binary prediction based on global genomic architectures. Alongside the prediction, a series of statistics are provided that help to assess the confidence of the prediction.  

# Implementation
BPP samples complete genome assemblies in batch to extract the features associated with global genomic architecture, including GC skew, AT skew, and a series of other genomic features derived from the characterization of nucleotide bias [@Arakawa2007-ks; Arakawa2009-bx]. These features are then used as input for three pre-trained different machine learning models based on logistic regression, XGBoost, and k-nearest neighbors (kNN). Although optimized during development of this tool, parameters can be fine-tuned according to researcher's need. Use of defalut parameters can already give users a biologically meaningful prediction, allowing them focus on the correlational or causational interpretation of this phenotype with minimal inteference with parameters. Besides, a series of plots visualizing the confidence of prediction and the relationships with lebeled trainng data is given at the end. (\autoref{fig:workflow})
![BacterialPloidyPredictor.\label{fig:workflow}](figures/BacterialPloidyPredictor-flowchart.png)
In summary, BPP provides the following functions:

- **Batch automation of pre-processing and feature extraction**:
  BPP treats *.fasta/*.fna/*.fa files containing complete genome assemblies as input, and gives them an optional genome completeness estimation using CheckM2 [@Chklovski2023-gu]. Extracted features including genomic GC skew, genomic AT skew, degrees of local fluctuations, and relative distances between replication origin and replication terminus and their interaction features are used for downstream prediction.
  
- **Illustration extracted features**:
  Extracted features including GC skew and AT skew will be provided for researchers interested in visualizing any bacterial chromosome for their own studies. Given baceria have a wide diversity of genomic structure, e.g. some species such as *Borrelia sp.* have linear chromosomes while most bacterial species possess circular chromosomes, both circular and linear GC skew and AT skew will be provided.
  
- **Prediction of monoploidy/polyploidy based on extracted features**:
  Use one of the pre-trained models including logistic regression, XGBoost, or kNN (default) to predict the species being monoploidy or polyploidy. Based on the dataset summarized from previous works, kNN currently has the highest prediction accuracy. Below is a table for comparing performacne of three models.

  | Model | Accuracy | Precision | Recall | F1 score |
  | :-------: | :------: | :-------: | :-------: | :-------: |
  | Multinomial Logistic regression | 0.675 | - | - | - |
  | XGBoost | 0.700 | - | - | - |
  | k-nearest neighbor | 0.725 | - | - | - |

- **Estimation of prediction confidence**:
  If using kNN (default), the Euclidean distance in PC1-PC2-PC3 space between each individual sample point and its nearest reference point will be calculated and placed in the distribution of pairwise Euclidean distance among reference data either from the same group (within-group distance distribution) or different groups (between-group distance distribution) to calculate the quantile of the sample distance in two distributions ($q_{in}$ for within-group quantile, and $q_{btw}$ for between group quantile). We termed PED.confidence (pairwise Euclidean Distance-based confidence) as:
  
  $PED.confidence=(1-q_{in})*(1-q_{btw})$
  
  to quantify the relative confidence of the prediction. Additionally, PCA space formed by first three principal components will be visualized as well with sampling data and reference data. If using multinomial logistic regression or XGBoost, prediction confidence will be given as the output of predict.proba() function under scikit-learn package.

  
# Outputs
To demonstarte, we ran BPP using three complete genome files from species *Escherichia coli*, *Synechocystis sp. PCC 6803*, and *Citrobacter freundii*. *E.coli* and *Synechocystis sp. PCC 6803* has been revealed in previous works as monoploid and polyploid bacteria, respectively; while *C.freundii* has never been tested before. Therefore, *C.freundii* was used as a species for testing the performance of our model. We predicted it using BPP and then validated it as polyploidy experimentally during stationary phase, which proves the predictive power of our tool. Below is the demonstration of outputs for *C.freundii*:


# Acknowledgement
We are grateful to members from Dr. Raquel Dias lab for testing the tool and providing constructive feedbacks that perfectionate this package.
# References
